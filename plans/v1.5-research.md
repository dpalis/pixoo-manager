# Pesquisa para v1.5 - Pixoo Manager

> Arquivo de referência com toda pesquisa realizada em 27/12/2025

---

## Estado Atual do Projeto (v1.3.0)

### Métricas
- **Issues totais:** 110 (106 fechadas, 4 abertas)
- **PRs mergeados:** 19
- **Commits recentes:** 30+

### Issues Abertas
| # | Título | Prioridade | Tipo |
|---|--------|------------|------|
| 107 | Criar MediaProcessor service para desacoplar routers | P3 | code-quality |
| 106 | Memoizar gamma LUT para imagens escuras | P3 | performance |
| 105 | Otimizar verificação de segmento com FFprobe | P3 | performance |
| 89 | Gamma adaptativo para imagens escuras | - | feature |

### Features Completas
| Categoria | Features |
|-----------|----------|
| **Conexão** | mDNS discovery, IP manual, singleton thread-safe |
| **GIF** | Upload, conversão 64x64, preview escalado, envio |
| **Mídia** | Foto/vídeo, crop com Cropper.js, EXIF rotation |
| **YouTube** | Download parcial (3 métodos), Shorts até 60s |
| **Qualidade** | Adaptive enhancement, gamma para imagens escuras |
| **UX** | Precision slider, drag-drop, progress SSE, heartbeat |
| **Segurança** | CSRF, rate limiting, SSRF prevention, validators |
| **Infra** | Menu bar macOS, py2app bundle, logging estruturado |

---

## Instruções do Usuário (Arquivo Original)

1. Entender a limitação de frames (FPS) do Pixoo
2. Pesquisar soluções para escrever recados no Pixoo (nova aba)
3. Verificar se GIFs podem rodar em loop
4. Pesquisar outras ideias criativas

---

## 1. Limitação de Frames/FPS

### Limites Descobertos

| Limite | Valor | Onde se aplica |
|--------|-------|----------------|
| Upload via HTTP API | **~40 frames** | `Draw/SendHttpGif` |
| Armazenamento local | 92 frames | Cartão SD/galeria |

### Por que GIFs de 10s não funcionam
- A 10 FPS: 10s = 100 frames (excede limite de 40)
- A 8 FPS: 10s = 80 frames (ainda excede)
- A 4 FPS: 10s = 40 frames (funciona, mas fica choppy)

### Configuração Atual (`config.py`)
```python
MAX_UPLOAD_FRAMES = 40      # Limite para envio
MAX_CONVERT_FRAMES = 92     # Limite para conversão
```

### Problema Identificado
Estamos permitindo criar GIFs de até 92 frames, mas só conseguimos enviar 40.

### Soluções Propostas
1. **Opção A:** Limitar conversão a 40 frames (4s a 10fps, ou 10s a 4fps)
2. **Opção B:** Downsampling automático - criar com 92, reduzir para 40 no upload
3. **Opção C:** Mostrar alerta claro na UI: "Para upload direto, máximo 40 frames"

### Fonte
- [Grayda/pixoo_api NOTES.md](https://github.com/Grayda/pixoo_api/blob/main/NOTES.md)
  - "There is a maximum of about 40 frames, so if your animation has more frames than this, your Pixoo may crash."

---

## 2. Escrever Recados no Pixoo (Nova Aba)

### API Oficial Existe!

```python
{
    "Command": "Draw/SendHttpText",
    "TextId": 1,
    "x": 0,
    "y": 24,
    "dir": 0,        # 0=esquerda, 1=direita
    "font": 2,       # Índice da fonte
    "TextWidth": 64,
    "TextString": "Olá Mundo!",
    "speed": 10,     # Velocidade do scroll
    "color": "#FFFFFF",
    "align": 1       # 1=esquerda, 2=centro, 3=direita
}
```

### Ferramentas de Referência
- [Pixoo64-Advanced-Tools](https://github.com/tidyhf/Pixoo64-Advanced-Tools) - "Powerful Text Displayer" com fontes, cores, outline, efeitos
- [Pixoo-64-Tools](https://github.com/itsmikethetech/Pixoo-64-Tools) - Envio de texto simples
- [pixoo-rest](https://github.com/4ch1m/pixoo-rest) - API REST completa
- [pixoo PyPI](https://pypi.org/project/pixoo/) - Lib Python oficial

### Limitações Conhecidas
- Texto só pode ser scrolling left com a maioria das fontes
- Não se pode sobrepor texto em GIFs do cartão SD (só em GIFs enviados via HTTP)
- Chamar push() mais de 1x/segundo pode travar o dispositivo

### Proposta para Nova Aba "Recados"
- Campo de texto livre
- Seletor de cor (color picker)
- Velocidade do scroll (slider)
- Seleção de fonte (dropdown)
- Preview em tempo real
- Botão "Enviar para Pixoo"

---

## 3. Loop Automático nos GIFs

### Conclusão: Já funciona!

GIFs enviados via `Draw/SendHttpGif` rodam em loop infinito automaticamente até:
- Enviar outro conteúdo
- Mudar de canal no app Divoom
- Desligar o dispositivo

Não precisa de configuração extra. O Pixoo trata todo conteúdo HTTP como loop contínuo.

---

## 4. Outras Ideias Criativas

### Projetos Populares no GitHub

| Projeto | Funcionalidade |
|---------|----------------|
| [Pixoo64-Advanced-Tools](https://github.com/tidyhf/Pixoo64-Advanced-Tools) | Tudo: texto, Spotify, system monitor, AI image gen, webcam, RSS |
| [SomethingWithComputers/pixoo](https://github.com/SomethingWithComputers/pixoo) | Lib Python, exemplo de consumo de energia |
| [r12f/divoom](https://github.com/r12f/divoom) | Lib Rust com CLI completa |
| [pixoo-rest](https://github.com/4ch1m/pixoo-rest) | API REST para integrar com qualquer coisa |
| [itsmikethetech/Pixoo-64-Tools](https://github.com/itsmikethetech/Pixoo-64-Tools) | Screen streaming, text messages, screenshots |

### Ideias da Comunidade
- **Spotify Album Art** - mostra capa do álbum + progresso + letras
- **System Monitor** - CPU, GPU, RAM, network em tempo real
- **Audio Visualizer** - bars, radial pulse, vortex
- **RSS Feeds** - notícias scrollando
- **Nightscout** - glicemia para diabéticos
- **Qualidade do Ar** - dados de sensores da comunidade
- **Relógio Custom** - com data, clima, etc.
- **Webcam streaming** - com save frame
- **AI image generation** - integrado no app

### Funcionalidades Adicionais da API
- Controle de brightness
- Seleção de canal
- Visualizer modes
- Device configuration
- GIF playback de URL

---

## Priorização Sugerida para v1.5

| Prioridade | Feature | Complexidade | Status |
|------------|---------|--------------|--------|
| P1 | Corrigir limite de frames (40 vs 92) | Baixa | TODO |
| P1 | Nova aba "Recados" (texto scrolling) | Média | TODO |
| P2 | Controle de brightness/canal | Baixa | TODO |
| P3 | Relógio/data customizado | Média | TODO |
| P3 | Integração Spotify (capa) | Alta | TODO |

---

## Análise de Gaps (o que NÃO existe ainda)

1. **Gestão de Galeria no Pixoo** - Listar/deletar animações salvas
2. **Batch Operations** - Upload de múltiplos GIFs
3. **Persistência Local** - Histórico, favoritos, configurações
4. **Conteúdo Gerado** - Texto animado, relógio, templates
5. **Outras Fontes** - TikTok/Instagram, Giphy/Tenor
6. **Integração Avançada** - Notificações, channel switching, brightness

---

## Fontes e Referências

### Documentação Oficial
- [Divoom Pixoo 64 Product Page](https://divoom.com/products/pixoo-64)
- [Divoom API Docs](http://doc.divoom-gz.com/web/#/12)

### GitHub
- [Grayda/pixoo_api](https://github.com/Grayda/pixoo_api/blob/main/NOTES.md) - Notas técnicas detalhadas
- [tidyhf/Pixoo64-Advanced-Tools](https://github.com/tidyhf/Pixoo64-Advanced-Tools) - Ferramenta avançada
- [SomethingWithComputers/pixoo](https://github.com/SomethingWithComputers/pixoo) - Lib Python
- [4ch1m/pixoo-rest](https://github.com/4ch1m/pixoo-rest) - REST API wrapper
- [r12f/divoom](https://github.com/r12f/divoom) - Lib Rust
- [itsmikethetech/Pixoo-64-Tools](https://github.com/itsmikethetech/Pixoo-64-Tools) - Tools collection

### Comunidade
- [Home Assistant Community - Pixoo 64](https://community.home-assistant.io/t/divoom-pixoo-64/420660)
- [GitHub Topics: divoom](https://github.com/topics/divoom)
- [GitHub Topics: pixoo64](https://github.com/topics/pixoo64)

### PyPI
- [pixoo](https://pypi.org/project/pixoo/) - Lib oficial
- [pixoo1664](https://pypi.org/project/pixoo1664/) - Lib alternativa
- [divoom (Rust)](https://docs.rs/crate/divoom/latest) - Docs Rust
